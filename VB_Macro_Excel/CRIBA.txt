Sub CRIBA_ERATOSTENES()

Dim FILA As Integer, N As Integer
Dim CONT As Integer, AUX As Integer, i As Integer

Range("D3").Value = "N° PRIMOS"
Range("C3").Value = "NUMEROS"
Range("D4").Value = "1"
Range("C4").Value = "1"

Do
    N = InputBox("Introduzca el número hasta donde llegará su serie de Criba", "CRIBA")
    If N <= 5 Then
        E = MsgBox("El número no puede ser negativo o menor a 5", vbOKOnly + vbCritical)
    End If
Loop Until N > 5

FILA1 = 5
AUX = 2

Do
Cells(FILA1, 3).Value = AUX
AUX = AUX + 1
FILA1 = FILA1 + 1
Loop Until AUX = N + 1

With Range(Cells(3, 3), Cells(N + 3, 4))
    .Borders.Weight = 2
    .HorizontalAlignment = xlCenter
End With

CONT = 2
FILA2 = 5

If CONT = 2 Then
    Cells(FILA2, 4).Value = CONT
    FILA2 = FILA2 + 1
End If

CONT = CONT + 1

Do
    For i = 1 To 9999
    If CONT Mod i = 0 Then
    A = A + 1
    End If
    Next i
    
    If A = 2 Then
        Cells(FILA2, 4).Value = CONT
        FILA2 = FILA2 + 1
    End If
    
CONT = CONT + 1
A = 0
Loop Until FILA2 = FILA1

End Sub
